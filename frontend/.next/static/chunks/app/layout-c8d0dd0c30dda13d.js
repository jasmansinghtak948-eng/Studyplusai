(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[185],{79380:function(e,t,o){Promise.resolve().then(o.bind(o,71245)),Promise.resolve().then(o.t.bind(o,69268,23))},71245:function(e,t,o){"use strict";o.d(t,{AuthProvider:function(){return c},a:function(){return i}});var s=o(57437),r=o(2265),a=o(28223);let n=(0,r.createContext)(void 0);function c(e){let{children:t}=e,[o,c]=(0,r.useState)(null),[i,u]=(0,r.useState)(!0);(0,r.useEffect)(()=>{(async()=>{if(localStorage.getItem("access_token"))try{let e=await a.E.getCurrentUser();c(e.user)}catch(e){console.log("Auth check failed")}u(!1)})()},[]);let l=async(e,t)=>{let o=await a.E.login({email:e,password:t});localStorage.setItem("access_token",o.tokens.access_token),localStorage.setItem("refresh_token",o.tokens.refresh_token),c(o.user)},h=async(e,t,o)=>{let s=await a.E.register({email:e,name:t,password:o});localStorage.setItem("access_token",s.tokens.access_token),localStorage.setItem("refresh_token",s.tokens.refresh_token),c(s.user)};return(0,s.jsx)(n.Provider,{value:{user:o,loading:i,isAuthenticated:!!o,login:l,register:h,logout:()=>{localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token"),c(null)}},children:t})}function i(){let e=(0,r.useContext)(n);if(void 0===e)throw Error("useAuth must be used within AuthProvider");return e}},28223:function(e,t,o){"use strict";o.d(t,{E:function(){return r}});let s=o(83464).Z.create({baseURL:"http://localhost:8000",headers:{"Content-Type":"application/json"}});s.interceptors.request.use(e=>{let t=localStorage.getItem("access_token");return t&&(e.headers.Authorization="Bearer ".concat(t)),e}),s.interceptors.response.use(e=>e.data,e=>{var t;return(null===(t=e.response)||void 0===t?void 0:t.status)===401&&(localStorage.removeItem("access_token"),localStorage.removeItem("refresh_token")),Promise.reject(e)});let r={register:e=>s.post("/api/v1/auth/register",e),login:e=>s.post("/api/v1/auth/login",e),googleAuth:e=>s.post("/api/v1/auth/google",e),appleAuth:e=>s.post("/api/v1/auth/apple",e),getCurrentUser:()=>s.get("/api/v1/auth/me"),uploadTest:e=>s.post("/api/v1/tests/upload",e),getTestHistory:e=>s.get("/api/v1/tests/history?limit=".concat(e||10)),getDashboard:()=>s.get("/api/v1/tests/dashboard"),getRecommendations:()=>s.get("/api/v1/tests/recommendations")}},69268:function(){}},function(e){e.O(0,[825,464,971,117,744],function(){return e(e.s=79380)}),_N_E=e.O()}]);